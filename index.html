<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" /> 
	<meta http-equiv="Pragma" content="no-cache" /> 
	<meta http-equiv="Expires" content="0" />
    <meta name = "format-detection" content="telephone = no" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <title>星驰达零食盒子</title>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="stylesheet" type="text/css" href="./theme-default/css/main@v1.1.css"/>
</head>
<body>
	<div id="app" class="loadImg" v-show="loadingShow">
		<img src="./theme-default/img/index-icon/loading.gif"/>
	</div>
<script src="./theme-default/js/vue.js" type="text/javascript" charset="utf-8"></script>
<script src="./theme-default/js/element-ui@2.4.1.js" type="text/javascript" charset="utf-8"></script>
<script src="./theme-default/js/axios.min.js" type="text/javascript" charset="utf-8"></script>
<script src="./theme-default/js/public@v1.0.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" charset="utf-8">
var vm = new Vue({  
    el: '#app',
    data: {
    	boxId : getParam('boxId'),
    	schoolId : getParam('schoolId'),
    	flag : getParam('flag'),
    	themeUrl : './theme-default',
    	UrlHaveFlag : '',
    	UrlNoFlag : '',
    	loadingShow : true
    },
    mounted: function (){
    	this.initAjax('./data.json');
	},
	methods: {
		//init parameter
		initParam(){
    		var H5params = {
    			"funCode": "themeType"
    		}
    		H5params = JSON.stringify(H5params);
    		//3des数据加密
      		var initEnterData = encrypt.encryptByDES(H5params);
    		var ajaxParm = {
    			"H5params":initEnterData
			}
        },
        //public axios
		initAjax(respUrl) {
			//get themeType
			axios({
	  			url: respUrl,
				method: 'get',
	//			data: ajaxParm,
			}).then(resp => {
				var Data = resp.data;
				if(Data.resultCode == '0'){
					var themeType = Data.themeType;
					if (themeType) {
		    			//1:Mid-autumn Festival; 2:National Day; 3:Hallowmas
		    			if (themeType == 1) {
		    				this.themeUrl = './theme-moon';
		    			}else if (themeType == 2) {
		    				this.themeUrl = './theme-NationalDay';
		    			}else if (themeType == 3) {
		    				this.themeUrl = './theme-Hallowmas';
		    			}
		    		}
		    		this.UrlHaveFlag = this.themeUrl + '/home.html?boxId=' + this.boxId + '&schoolId=' + this.schoolId + '&flag=' + this.flag + '&random=' + Math.random()*1000;
		    		this.UrlNoFlag = this.themeUrl + '/home.html?boxId=' + this.boxId + '&random=' + Math.random()*1000;
		    		if (this.boxId && this.schoolId && (this.flag == 'Y')) {
		    			window.location.replace(this.UrlHaveFlag); 			
		    		} else{
		    			window.location.replace(this.UrlNoFlag);
		    		}
				}else{
					this.loadingShow = false;
					this.message(Data.resultMessage,'error');
				}
			}).catch(err => {
				this.message(err,'error');
		   	});
		}
	}
});
</script>
</body>
</html>